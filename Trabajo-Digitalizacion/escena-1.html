<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>escena 1</title>
        <!--laboratorio 360Âº con sonidos-->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>
<body>
<a-scene xr-mode-ui="enabled: true" webxr="optionalFeatures: [ 'local-floor', 'bounded-floor', 'hand-tracking', 'layers' ]" shadow="type: pcfsoft">
<a-entity id="player" camera position="1.5 2 2" shadow>
</a-entity>
<a-assets>
    <a-asset-item id="pokeball" src="assets/models/pokemon_basic_pokeball/scene.gltf"></a-asset-item>
    <a-asset-item id="chimchar" src="assets/models/chimchar/scene.gltf"></a-asset-item>
    <a-asset-item id="piplup" src="assets/models/piplup/scene.gltf"></a-asset-item>
    <a-asset-item id="turtwig" src="assets/models/turtwig/scene.gltf"></a-asset-item>
</a-assets>

      <a-entity webxr-input-profiles></a-entity>

<a-entity id="rig" position="1.5 2 2">
    <a-entity camera></a-entity>

    <a-entity laser-controls="hand: left"
              raycaster="objects: .clickable"
              cursor="fuse: false"></a-entity>

    <a-entity laser-controls="hand: right"
              raycaster="objects: .clickable"
              cursor="fuse: false"></a-entity>
  </a-entity>

<!-- ðŸŽµ Archivo de sonido -->
<audio id="bgMusic" src="assets/sounds/Pokemon Ruby_Sapphire_Emerald- Littleroot Town [im6tbN9SZXs].mp3" preload="auto"></audio>

    <audio id="chimcharSound" src="assets/sounds/Pokemon Cries - #390 Chimchar [migsHlYTvAQ].mp3" preload="auto"></audio>
    <audio id="piplupSound" src="assets/sounds/Pokemon Cries - #393 Piplup [s1z6FMszhK8].mp3" preload="auto"></audio>
    <audio id="turtwigSound" src="assets/sounds/Pokemon Cries - #387 Turtwig [IgGou6Hvhnc].mp3" preload="auto"></audio>
</a-assets>

<!-- Entidad que reproduce el sonido -->
<a-entity sound="src: #bgMusic; autoplay: true; loop: true; volume: 0.5"></a-entity>

<a-entity id="chimcharAudio" sound="src: #chimcharSound; volume: 1"></a-entity>
<a-entity id="piplupAudio" sound="src: #piplupSound; volume: 1"></a-entity>
<a-entity id="turtwigAudio" sound="src: #turtwigSound; volume: 1"></a-entity>

<!-- Luz direccional con sombras -->
<a-entity light="type: directional; intensity: 0.8; castShadow: true" 
        position="2 4 2" 
        shadow="cameraLeft: -10; cameraRight: 10; cameraBottom: -10; cameraTop: 10">
</a-entity>

<!-- Luz ambiental para iluminaciÃ³n general -->
<a-entity light="type: ambient; intensity: 0.4"></a-entity>
<!-- Fondo 360 del laboratorio -->
<a-box position="0 0 -5" width="20" height="0.5" depth="20" color="lightcoral" static-body shadow="cast: true"></a-box> <!-- Suelo -->
<a-box position="0 5 -5" width="20" height="0.5" depth="20" color="White" static-body shadow="cast: false"></a-box> <!-- Techo -->
<a-box position="-10 2.5 -5" width="0.5" height="5" depth="20" color="white" static-body shadow="cast: true"></a-box> <!-- Pared izquierda -->
<a-box position="10 2.5 -5" width="0.5" height="5" depth="20" color="White" static-body shadow="cast: true"></a-box> <!-- Pared derecha -->
<a-box position="0 2.5 -15" width="20" height="5" depth="0.5" color="lightgrey" static-body shadow="cast: true"></a-box> <!-- Pared fondo -->
<!-- Puerta izquierda -->
<a-box position="-1 1.5 -15" width="2" height="3" depth="1" color="#654321" shadow="cast: true"></a-box>

<!-- Puerta derecha -->
<a-box position="1 1.5 -15" width="2" height="3" depth="1" color="#654321" shadow="cast: true"></a-box>
<!-- Manillas doradas -->
<a-sphere position="-0.5 1.5 -14.9" radius="0.45" color="yellow"></a-sphere>
<a-sphere position="0.5 1.5 -14.9" radius="0.45" color="yellow"></a-sphere>

<a-box position="0 2.5 5" width="20" height="5" depth="0.5" color="white" static-body shadow="cast: true"></a-box> <!-- Pared frente -->

<!-- Mesa para las PokÃ©balls -->
<a-box position="1.05 0.7 -3" width="3" height="0.1" depth="1" color="#8B4513" shadow="receive: true"></a-box> <!-- Superficie -->

<!-- Patas de la mesa -->
<a-box position="-0.4 0.50 -3.4" width="0.1" height="0.5" depth="0.1" color="#5C4033" shadow="receive: true"></a-box>
<a-box position="2.5 0.50 -3.4" width="0.1" height="0.5" depth="0.1" color="#5C4033" shadow="receive: true"></a-box>
<a-box position="-0.4 0.50 -2.6" width="0.1" height="0.5" depth="0.1" color="#5C4033" shadow="receive: true"></a-box>
<a-box position="2.5 0.50 -2.6" width="0.1" height="0.5" depth="0.1" color="#5C4033" shadow="receive: true"></a-box>
<!-- PokÃ©balls en la mesa -->   
<a-gltf-model src="#pokeball" position="0.08 1 -3" scale="0.05 0.05 0.05" id="ball1" class="clickable" static-body shadow="cast: true"></a-gltf-model>
<a-gltf-model src="#pokeball" position="1.08 1 -3" scale="0.05 0.05 0.05" id="ball2" class="clickable" static-body shadow="cast: true"></a-gltf-model>
<a-gltf-model src="#pokeball" position="2.08 1 -3" scale="0.05 0.05 0.05" id="ball3" class="clickable" static-body shadow="cast: true"></a-gltf-model>
<!--PokÃ©ball continuar-->
<a-gltf-model src="#pokeball" position="4.08 0.5 -3" scale="0.05 0.05 0.05" id="ball4" class="clickable" onclick="window.location='escena-2.html'" static-body shadow="cast: true"></a-gltf-model>
<!-- Texto de selecciÃ³n -->
<a-text id="mensaje" value="Elige tu Pokemon" position="0.2 3 -3" color="Black"></a-text>
<!--texto pokeball continuar-->
<a-text id="mensaje" value="Continuar" position="3.6 1 -3" color="Black"></a-text>
<!-- Modelos ocultos de PokÃ©mon -->
<a-gltf-model id="chimcharModel" src="#chimchar" position="2 1 -6" scale="0.3 0.3 0.3" visible="false" shadow="cast: true"></a-gltf-model>
<a-gltf-model id="piplupModel" src="#piplup" position="2 1 -6" scale="0.3 0.3 0.3" visible="false" shadow="cast: true"></a-gltf-model>
<a-gltf-model id="turtwigModel" src="#turtwig" position="2 1 -6" scale="0.3 0.3 0.3" visible="false" shadow="cast: true"></a-gltf-model>

<!-- Pregunta de confirmaciÃ³n -->
<a-text id="pregunta" value="" position="0 3 -6" color="black" visible="false"></a-text>
<!-- BotÃ³n de confirmaciÃ³n -->
<a-box id="botonSi" position="0 1.5 -6" width="1" height="0.5" depth="0.1" color="green" visible="false" class="clickable"></a-box>
<a-text value="Si" position="-0.1 1.5 -5.95" color="white" visible="false" id="textoSi">

<a-entity cursor="rayOrigin: mouse" raycaster="objects: .clickable"></a-entity>

<a-entity laser-controls="hand: left" raycaster="objects: .clickable"></a-entity>
<a-entity laser-controls="hand: right" raycaster="objects: .clickable"></a-entity>

<script>
let confirmacionHecha = false;
const mensaje = document.querySelector('#mensaje');
const pregunta = document.querySelector('#pregunta');

const chimcharModel = document.querySelector('#chimcharModel');
const piplupModel = document.querySelector('#piplupModel');
const turtwigModel = document.querySelector('#turtwigModel');

const botonSi = document.querySelector('#botonSi');
const textoSi = document.querySelector('#textoSi');

let pokemonElegido = '';

function mostrarPokemon(modelo, texto, nombre) {
    chimcharModel.setAttribute('visible', false);
    piplupModel.setAttribute('visible', false);
    turtwigModel.setAttribute('visible', false);

    modelo.setAttribute('visible', true);
    pregunta.setAttribute('value', texto);
    pregunta.setAttribute('visible', true);

    botonSi.setAttribute('visible', true);
    textoSi.setAttribute('visible', true);

    pokemonElegido = nombre;
}

document.querySelector('#ball1').addEventListener('click', () => {
    mensaje.setAttribute('value', 'Has elegido a Chimchar');
    mostrarPokemon(chimcharModel, 'Â¿Quieres a Chimchar, el Pokemon tipo fuego?', 'Chimchar');
});

document.querySelector('#ball2').addEventListener('click', () => {
    mensaje.setAttribute('value', 'Has elegido a Piplup');
    mostrarPokemon(piplupModel, 'Â¿Quieres a Piplup, el Pokemon tipo agua?', 'Piplup');
});

document.querySelector('#ball3').addEventListener('click', () => {
    mensaje.setAttribute('value', 'Has elegido a Turtwig');
    mostrarPokemon(turtwigModel, 'Â¿Quieres a Turtwig, el Pokemon tipo planta?', 'Turtwig');
});

document.querySelector('#ball4').addEventListener('click', () => {
    mensaje.setAttribute('value','Museo');
    mostrarPokemon('Museo');
});

botonSi.addEventListener('click', () => {
  if (confirmacionHecha) return; // Evita que se repita

    localStorage.setItem('pokemonElegido', pokemonElegido.toLowerCase());

mensaje.setAttribute('value', `Â¡${pokemonElegido} es tu amigo Pokemon!`);
pregunta.setAttribute('visible', false);
botonSi.setAttribute('visible', false);
textoSi.setAttribute('visible', false);


  // Mostrar el portal
document.querySelector('#portal').setAttribute('visible', true);
document.querySelector('#textoPortal').setAttribute('visible', true);

  confirmacionHecha = true; // Marca como confirmado
});

document.body.addEventListener('click', () => {
const bgEntity = document.querySelector('[sound]');
bgEntity.components.sound.playSound();
}, {once: true});

const chimcharAudio = document.querySelector('#chimcharAudio');
const piplupAudio = document.querySelector('#piplupAudio');
const turtwigAudio = document.querySelector('#turtwigAudio');

document.querySelector('#ball1').addEventListener('click', () => {
    mensaje.setAttribute('value', 'Has elegido a Chimchar');
    mostrarPokemon(chimcharModel, 'Â¿Quieres a Chimchar, el Pokemon tipo fuego?', 'Chimchar');
    chimcharAudio.components.sound.playSound(); // ðŸ”Š Reproduce sonido
});

document.querySelector('#ball2').addEventListener('click', () => {
    mensaje.setAttribute('value', 'Has elegido a Piplup');
    mostrarPokemon(piplupModel, 'Â¿Quieres a Piplup, el Pokemon tipo agua?', 'Piplup');
    piplupAudio.components.sound.playSound(); // ðŸ”Š Reproduce sonido
});

document.querySelector('#ball3').addEventListener('click', () => {
    mensaje.setAttribute('value', 'Has elegido a Turtwig');
    mostrarPokemon(turtwigModel, 'Â¿Quieres a Turtwig, el Pokemon tipo planta?', 'Turtwig');
    turtwigAudio.components.sound.playSound(); // ðŸ”Š Reproduce sonido
});
</script>

    
</a-scene>

</html>

