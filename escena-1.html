<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>escena 1</title>
        <!--laboratorio 360º con sonidos-->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>
<body>
<a-scene shadow="type: pcfsoft">
<a-entity id="player" camera position="1.5 2 2" shadow>
    <a-entity 
    cursor="fuse: false; rayOrigin: mouse" 
    raycaster="objects: .clickable"
    position="0 0 -1">
    </a-entity>
</a-entity>
<a-assets>
    <a-asset-item id="pokeball" src="assets/models/pokemon_basic_pokeball/scene.gltf"></a-asset-item>
    <a-asset-item id="chimchar" src="assets/models/chimchar/scene.gltf"></a-asset-item>
    <a-asset-item id="piplup" src="assets/models/piplup/scene.gltf"></a-asset-item>
    <a-asset-item id="turtwig" src="assets/models/turtwig/scene.gltf"></a-asset-item>
</a-assets>

<!-- Luz direccional con sombras -->
<a-entity light="type: directional; intensity: 0.8; castShadow: true" 
        position="2 4 2" 
        shadow="cameraLeft: -10; cameraRight: 10; cameraBottom: -10; cameraTop: 10">
</a-entity>

<!-- Luz ambiental para iluminación general -->
<a-entity light="type: ambient; intensity: 0.4"></a-entity>
<!-- Fondo 360 del laboratorio -->
<a-box position="0 0 -5" width="20" height="0.5" depth="20" color="lightcoral" static-body shadow="cast: true"></a-box> <!-- Suelo -->
<a-box position="0 5 -5" width="20" height="0.5" depth="20" color="White" static-body shadow="cast: false"></a-box> <!-- Techo -->
<a-box position="-10 2.5 -5" width="0.5" height="5" depth="20" color="white" static-body shadow="cast: true"></a-box> <!-- Pared izquierda -->
<a-box position="10 2.5 -5" width="0.5" height="5" depth="20" color="White" static-body shadow="cast: true"></a-box> <!-- Pared derecha -->
<a-box position="0 2.5 -15" width="20" height="5" depth="0.5" color="lightgrey" static-body shadow="cast: true"></a-box> <!-- Pared fondo -->
<!-- Puerta izquierda -->
<a-box position="-1 1.5 -15" width="2" height="3" depth="1" color="#654321" shadow="cast: true"></a-box>

<!-- Puerta derecha -->
<a-box position="1 1.5 -15" width="2" height="3" depth="1" color="#654321" shadow="cast: true"></a-box>
<!-- Manillas doradas -->
<a-sphere position="-0.5 1.5 -14.9" radius="0.45" color="yellow"></a-sphere>
<a-sphere position="0.5 1.5 -14.9" radius="0.45" color="yellow"></a-sphere>

<a-box position="0 2.5 5" width="20" height="5" depth="0.5" color="white" static-body shadow="cast: true"></a-box> <!-- Pared frente -->

<!-- Mesa para las Pokéballs -->
<a-box position="1.05 0.7 -3" width="3" height="0.1" depth="1" color="#8B4513" shadow="receive: true"></a-box> <!-- Superficie -->

<!-- Patas de la mesa -->
<a-box position="-0.4 0.50 -3.4" width="0.1" height="0.5" depth="0.1" color="#5C4033" shadow="receive: true"></a-box>
<a-box position="2.5 0.50 -3.4" width="0.1" height="0.5" depth="0.1" color="#5C4033" shadow="receive: true"></a-box>
<a-box position="-0.4 0.50 -2.6" width="0.1" height="0.5" depth="0.1" color="#5C4033" shadow="receive: true"></a-box>
<a-box position="2.5 0.50 -2.6" width="0.1" height="0.5" depth="0.1" color="#5C4033" shadow="receive: true"></a-box>
<!-- Pokéballs en la mesa -->   
<a-gltf-model src="#pokeball" position="0.08 1 -3" scale="0.05 0.05 0.05" id="ball1" class="clickable" static-body shadow="cast: true"></a-gltf-model>
<a-gltf-model src="#pokeball" position="1.08 1 -3" scale="0.05 0.05 0.05" id="ball2" class="clickable" static-body shadow="cast: true"></a-gltf-model>
<a-gltf-model src="#pokeball" position="2.08 1 -3" scale="0.05 0.05 0.05" id="ball3" class="clickable" static-body shadow="cast: true"></a-gltf-model>
<!--Pokéball continuar-->
<a-gltf-model src="#pokeball" position="4.08 0.5 -3" scale="0.05 0.05 0.05" id="ball4" class="clickable" onclick="window.location='escena-2.html'" static-body shadow="cast: true"></a-gltf-model>
<!-- Texto de selección -->
<a-text id="mensaje" value="Elige tu Pokemon" position="0.2 3 -3" color="Black"></a-text>
<!--texto pokeball continuar-->
<a-text id="mensaje" value="Continuar" position="3.6 1 -3" color="Black"></a-text>
<!-- Modelos ocultos de Pokémon -->
<a-gltf-model id="chimcharModel" src="#chimchar" position="2 1 -6" scale="0.3 0.3 0.3" visible="false" shadow="cast: true"></a-gltf-model>
<a-gltf-model id="piplupModel" src="#piplup" position="2 1 -6" scale="0.3 0.3 0.3" visible="false" shadow="cast: true"></a-gltf-model>
<a-gltf-model id="turtwigModel" src="#turtwig" position="2 1 -6" scale="0.3 0.3 0.3" visible="false" shadow="cast: true"></a-gltf-model>

<!-- Pregunta de confirmación -->
<a-text id="pregunta" value="" position="0 3 -6" color="black" visible="false"></a-text>
<!-- Botón de confirmación -->
<a-box id="botonSi" position="0 1.5 -6" width="1" height="0.5" depth="0.1" color="green" visible="false" class="clickable"></a-box>
<a-text value="Si" position="-0.1 1.5 -5.95" color="white" visible="false" id="textoSi">


<script>
let confirmacionHecha = false;
const mensaje = document.querySelector('#mensaje');
const pregunta = document.querySelector('#pregunta');

const chimcharModel = document.querySelector('#chimcharModel');
const piplupModel = document.querySelector('#piplupModel');
const turtwigModel = document.querySelector('#turtwigModel');

const botonSi = document.querySelector('#botonSi');
const textoSi = document.querySelector('#textoSi');

let pokemonElegido = '';

function mostrarPokemon(modelo, texto, nombre) {
    chimcharModel.setAttribute('visible', false);
    piplupModel.setAttribute('visible', false);
    turtwigModel.setAttribute('visible', false);

    modelo.setAttribute('visible', true);
    pregunta.setAttribute('value', texto);
    pregunta.setAttribute('visible', true);

    botonSi.setAttribute('visible', true);
    textoSi.setAttribute('visible', true);

    pokemonElegido = nombre;
}

document.querySelector('#ball1').addEventListener('click', () => {
    mensaje.setAttribute('value', 'Has elegido a Chimchar');
    mostrarPokemon(chimcharModel, '¿Quieres a Chimchar, el Pokemon tipo fuego?', 'Chimchar');
});

document.querySelector('#ball2').addEventListener('click', () => {
    mensaje.setAttribute('value', 'Has elegido a Piplup');
    mostrarPokemon(piplupModel, '¿Quieres a Piplup, el Pokemon tipo agua?', 'Piplup');
});

document.querySelector('#ball3').addEventListener('click', () => {
    mensaje.setAttribute('value', 'Has elegido a Turtwig');
    mostrarPokemon(turtwigModel, '¿Quieres a Turtwig, el Pokemon tipo planta?', 'Turtwig');
});

document.querySelector('#ball4').addEventListener('click', () => {
    mensaje.setAttribute('value','Museo');
    mostrarPokemon('Museo');
});

botonSi.addEventListener('click', () => {
  if (confirmacionHecha) return; // Evita que se repita
// Guardar elección en localStorage
  localStorage.setItem('pokemonElegido', pokemonElegido.toLowerCase());

mensaje.setAttribute('value', `¡${pokemonElegido} es tu amigo Pokemon!`);
pregunta.setAttribute('visible', false);
botonSi.setAttribute('visible', false);
textoSi.setAttribute('visible', false);


  // Mostrar el portal
document.querySelector('#portal').setAttribute('visible', true);
document.querySelector('#textoPortal').setAttribute('visible', true);

  confirmacionHecha = true; // Marca como confirmado
});
</script>

    
</a-scene>
</html>